function J = jacobian(robot, q, tb)

r = robot.r;
L = robot.L;
L1 = robot.L1;
L2 = robot.L2;
L3 = robot.L3;
d = robot.d;

t1 = q(3);
t2 = q(4);
t3 = q(5);

J=[(1/2).*r.*cos(tb)+2.*d.^(-1).*L.*r.*sin(tb)+d.^(-1).*L1.*r.*sin( ...
  t1+tb)+d.^(-1).*L2.*r.*sin(t1+t2+tb)+d.^(-1).*L3.*r.*sin(t1+t2+t3+ ...
  tb),(1/2).*r.*cos(tb)+(-2).*d.^(-1).*L.*r.*sin(tb)+(-1).*d.^(-1).* ...
  L1.*r.*sin(t1+tb)+(-1).*d.^(-1).*L2.*r.*sin(t1+t2+tb)+(-1).*d.^( ...
  -1).*L3.*r.*sin(t1+t2+t3+tb),(-1).*L1.*sin(t1+tb)+(-1).*L2.*sin( ...
  t1+t2+tb)+(-1).*L3.*sin(t1+t2+t3+tb),(-1).*L2.*sin(t1+t2+tb)+(-1) ...
  .*L3.*sin(t1+t2+t3+tb),(-1).*L3.*sin(t1+t2+t3+tb);(-2).*d.^(-1).* ...
  L.*r.*cos(tb)+(-1).*d.^(-1).*L1.*r.*cos(t1+tb)+(-1).*d.^(-1).*L2.* ...
  r.*cos(t1+t2+tb)+(-1).*d.^(-1).*L3.*r.*cos(t1+t2+t3+tb)+(1/2).*r.* ...
  sin(tb),2.*d.^(-1).*L.*r.*cos(tb)+d.^(-1).*L1.*r.*cos(t1+tb)+d.^( ...
  -1).*L2.*r.*cos(t1+t2+tb)+d.^(-1).*L3.*r.*cos(t1+t2+t3+tb)+(1/2).* ...
  r.*sin(tb),L1.*cos(t1+tb)+L2.*cos(t1+t2+tb)+L3.*cos(t1+t2+t3+tb), ...
  L2.*cos(t1+t2+tb)+L3.*cos(t1+t2+t3+tb),L3.*cos(t1+t2+t3+tb);(-1).* ...
  d.^(-1).*r,d.^(-1).*r,1,1,1];


end